# Changelog

All notable changes to this project will be documented in this file.

The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/),
and this project adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html).

## [Unreleased]

### 待发布的更新将在这里记录

## [1.0.11] - 2025-02-03

### Added
- 启动时自动检查更新功能（延迟 2 秒，不阻塞启动）
- 精美的更新提示弹窗，显示版本对比和更新说明
- 底栏显示更新检查状态和新版本提示
- 支持「立即下载」和「稍后提醒」两种操作
- 每 24 小时自动检查一次更新

### Fixed
- 修复 Gitee 同步 SSL 证书验证失败问题（添加 -k 参数）
- 修复同步脚本版本号重复添加 v 前缀的问题
- 修复同步脚本 CHANGELOG 版本号匹配问题

### Changed
- 优化更新检查逻辑，静默处理失败情况
- 改进 GitHub Release 文件下载重试机制（最多 3 次）
- 手动同步脚本支持传入 1.0.10 或 v1.0.10 两种格式

### Removed
- 删除冗余的 sync-to-gitee.yml workflow（已集成到 release.yml）
- 清理 .kiro 目录下的 20+ 个临时开发文档
- 删除重复的文档文件

## [1.0.10] - 2025-02-02

### Added

#### 完整的应用菜单栏
- **文件菜单**：新建连接、新建分组、导入/导出配置、设置、退出
- **编辑菜单**：撤销/重做、剪切/复制/粘贴、查找、清屏
- **查看菜单**：切换侧边栏、放大/缩小/重置缩放、重新加载、开发者工具、全屏
- **窗口菜单**：水平/垂直分屏、关闭分屏、最小化/缩放/关闭
- **帮助菜单**：用户手册、报告问题、项目主页、检查更新、关于
- 所有主要功能都有快捷键支持
- macOS 和 Windows/Linux 有不同的菜单布局
- 菜单项通过 IPC 事件与渲染进程通信

#### 会话分组嵌套支持
- 支持多级嵌套分组（如：生产环境 → 数据库 → MySQL）
- 使用 `/` 分隔符表示层级关系
- 子分组显示带有缩进的层级结构
- 分组标题右侧的 **"+"** 按钮快速创建子分组
- 默认分组不支持创建子分组（限制）
- 分组排序：默认分组始终在最后，其他按名称排序
- 删除父分组会同时删除所有子分组

#### 侧边栏宽度拖拽调整
- 拖拽侧边栏右边缘调整宽度（200-600px，默认 250px）
- 拖拽时显示蓝色高亮提示
- 鼠标悬停时也显示高亮
- 调整后的宽度自动保存到 localStorage
- 拖拽时终端自动调整大小并通知 SSH 服务器
- 适应不同的使用场景和屏幕尺寸

#### 精美的关于对话框
- 展示应用 logo（带浮动动画）
- 显示应用名称、版本号、标语
- 6 个主要功能特性卡片（带悬停动画）
- 版权信息和 MIT License
- macOS 在应用菜单中，Windows/Linux 在帮助菜单中

#### 国际化支持（中英文）
- 完整的 i18n.js 国际化框架
- 300+ 翻译键，覆盖所有界面元素
- 支持中文（简体）和英文
- 语言切换后立即生效，无需重启
- 设置面板中的语言选择器
- 自动保存语言偏好

### Changed

- **优化界面显示密度**：
  - 分组标题：padding 从 8px 10px 减至 5px 8px，字体从 14px 减至 12px
  - 会话项：padding 从 8px 10px 减至 5px 8px，字体从 14px 减至 12px
  - 分组计数、切换图标、操作按钮等都相应减小
  - 整体高度减少约 30-40%，一屏能显示更多内容
- **精简侧边栏按钮**：移除"导出配置"和"导入配置"按钮（可通过菜单访问）
- **优化分组逻辑**：默认分组使用空字符串 `''` 作为内部标识，只在显示时使用翻译后的名称
- **改进菜单结构**：所有功能都可通过菜单和快捷键访问

### Fixed

- 修复 Windows 下查看日志失败的问题（使用 data-log-path 属性存储路径）
- 修复 Windows 路径反斜杠转义问题（通过 addEventListener 绑定事件）
- 修复默认分组的识别和分配逻辑
- 修复分组排序问题（默认分组始终在最后）
- 修复嵌套分组显示混乱的问题
- 修复 Windows 下 Ctrl+V 粘贴问题（使用 navigator.clipboard API）
- 修复全局快捷键冲突（Ctrl/Cmd+B 只在终端没有焦点时生效）

### Documentation

- 更新 README.md：
  - 添加新功能说明（嵌套分组、应用菜单、侧边栏可调、多语言等）
  - 更新功能特性列表
  - 更新核心功能说明
- 更新 USER_MANUAL.md：
  - 新增"应用菜单"章节，详细说明所有菜单功能和快捷键
  - 会话管理章节添加嵌套分组说明
  - 新增"侧边栏宽度调整"小节
  - 更新所有相关章节
- 修正 GitHub 仓库链接为 `chankay/AnotherSSH`

## [1.0.9] - 2025-01-30

### Fixed
- 修复主密码对话框样式问题：
  - 添加 dialog-body 包裹内容，统一对话框结构
  - 将 dialog-actions 改为 form-actions，与其他对话框保持一致
  - 优化对话框宽度、内边距、标题大小
  - 新增 form-hint 样式，带左侧主题色边框的提示信息框
  - 改善整体视觉效果和间距

## [1.0.8] - 2025-01-30

### Added
- 终端颜色自定义：支持自定义终端背景色、前景色、光标颜色
- 新增 11 种终端字体选项（JetBrains Mono、Source Code Pro、Cascadia Code 等）
- 终端设置整合到主题配置中，统一管理

### Fixed
- 修复分屏终端背景色覆盖不完整的问题
- 修复编辑连接对话框按钮逻辑（保存并连接）
- 移除终端容器 padding，避免底部黑色不可输入区域
- 修复 vim 等全屏应用底部空白问题（完整优化所有 resize 场景）：
  - 初始连接时增加延迟，确保大屏幕首次打开显示完整
  - 窗口大小变化时正确通知 SSH 调整终端尺寸
  - 标签切换时重新调整终端大小
  - 重连成功后重新调整终端大小
  - 分屏创建和渲染时正确调整每个面板大小
  - 关闭分屏时恢复单终端正确大小
  - 主题应用时重新调整终端大小（字体改变影响行列数）
  - 字体大小调整时通知 SSH 更新终端尺寸
  - 所有 resize 调用前都检查 cols 和 rows 有效性

### Changed
- 优化终端文字左侧间距（3px），改善视觉效果
- 优化会话列表和终端间距，界面更紧凑
- 弹窗样式美化：渐变背景、圆角、阴影、动画效果
- 所有弹窗支持滚动条，避免内容过长无法访问

### Performance
- 优化终端输入性能，使用单向 IPC 通信
- 启用 TCP_NODELAY 禁用 Nagle 算法
- 禁用 SSH 压缩，减少延迟
- 基本感觉不到卡顿

## [1.0.7] - 2025-01-29

### Fixed
- 修复字体大小 18-19 时文字重叠问题（添加 lineHeight: 1.2）
- 修复输入换行后卡顿问题（优化渲染性能）
- 增加终端内容距离底部状态栏的距离，改善视觉体验

### Changed
- 优化终端渲染性能，移除导致卡顿的 will-change 属性
- 使用高度限制替代 padding 避免布局重计算

### Infrastructure
- 配置 GitHub 到 Gitee 自动同步（代码 + Release + 附件）
- 使用 HTTPS + Token 方式推送，无需 SSH 密钥
- 添加历史 Release 同步脚本

## [1.0.6] - 2025-01-29

### Added

#### 主密码保护（可选）
- 应用级别的主密码保护，类似 MobaXterm、Xshell
- PBKDF2 加密算法（100,000 次迭代 + SHA-512）
- 首次启动可选择设置或跳过
- 设置后每次启动需要验证密码
- 支持修改和移除主密码
- 验证期间界面锁定保护
- 文件系统持久化（不依赖 localStorage）
- 设置面板中的"安全"标签页管理

#### 侧边栏收起/展开
- 快捷键 `Ctrl/Cmd + B` 切换侧边栏
- 侧边栏收起后显示展开按钮
- 状态持久化保存
- 获得更大的终端显示空间
- 平滑动画过渡效果

### Changed

- **启动性能优化**：会话列表立即显示，非关键功能延迟加载
- **并行 IPC 调用**：主密码检查使用 Promise.all 并行执行
- 优化初始化顺序，提升启动速度
- 改进主密码对话框显示逻辑

### Fixed

- 修复主密码持久化问题（localStorage 改为文件系统）
- 修复点击"暂不设置"后仍然弹出主密码对话框的问题
- 修复启动加载慢的问题（优化初始化顺序）
- 修复主密码对话框被设置界面遮挡的问题

### Documentation

- 更新 README 添加主密码功能说明
- 更新用户手册添加完整的主密码章节
- 添加主密码安全说明和最佳实践
- 更新配置文件列表
- 添加忘记主密码的处理方法

## [1.0.5] - 2025-01-29

### Added

#### 主密码保护（可选）
- 应用级别的主密码保护，类似 MobaXterm、Xshell
- PBKDF2 加密算法（100,000 次迭代 + SHA-512）
- 首次启动可选择设置或跳过
- 设置后每次启动需要验证密码
- 支持修改和移除主密码
- 验证期间界面锁定保护
- 文件系统持久化（不依赖 localStorage）
- 设置面板中的"安全"标签页管理

#### 侧边栏收起/展开
- 快捷键 `Ctrl/Cmd + B` 切换侧边栏
- 侧边栏收起后显示展开按钮
- 状态持久化保存
- 获得更大的终端显示空间
- 平滑动画过渡效果

#### 终端分屏
- 支持 2-4 个终端分屏，同时操作多台服务器
- 自动布局调整：2 分屏（水平/垂直）、3-4 分屏（网格布局）
- 快捷键支持：`Ctrl/Cmd + Shift + D`（水平分屏）、`Ctrl/Cmd + Shift + E`（垂直分屏）
- 支持选择已保存会话快速创建分屏
- 分屏会话选择支持搜索功能
- 单独关闭分屏，自动调整布局
- 点击分屏区域自动聚焦

#### 批量命令执行（同步输入）
- 三种同步模式：关闭 / 全部 / 分屏
- 实时显示当前模式和终端数量
- 按钮颜色指示当前状态
- 支持所有终端输入（命令、文本、特殊字符）
- 循环切换同步模式
- 适合批量更新、配置、监控多台服务器

#### 终端搜索
- 实时搜索终端内容
- 高亮显示所有匹配项（黄色背景）
- 当前匹配项特殊标记（橙色背景）
- 上一个/下一个匹配导航
- 大小写敏感选项
- 正则表达式支持
- 快捷键：`Ctrl/Cmd + F` 打开搜索

#### 会话自动重连
- 网络断开自动重连（最多 3 次）
- 重连倒计时显示
- 标签页状态指示（黄色闪烁表示重连中）
- 手动重连/取消按钮
- SSH keepalive 配置（30秒间隔，90秒检测）
- 智能检测：手动 exit/logout/quit 不触发重连
- 重连通知和进度显示

#### 会话标签颜色标记
- 7 种预设颜色：灰、绿、橙、红、蓝、紫、黄
- 标签页左侧彩色边框标识
- 建议配色：绿色（开发）、橙色（测试）、红色（生产）
- 颜色配置持久化保存

#### SSH 密钥文件浏览器
- 文件浏览器选择私钥文件
- 支持常见格式：.pem、.key、.ppk
- 无需手动输入路径
- 自动读取密钥内容

#### 会话分组折叠状态持久化
- 分组折叠状态自动保存
- 应用重启后恢复折叠状态
- 每个分组独立保存状态

### Changed

- **启动性能优化**：会话列表立即显示，非关键功能延迟加载
- **并行 IPC 调用**：主密码检查使用 Promise.all 并行执行
- 增强活动标签页视觉效果（蓝色底边、蓝色文字、加粗）
- 优化分屏布局和样式
- 改进重连通知界面
- 优化搜索框样式和交互
- 优化终端渲染性能
- 改进会话状态管理
- 优化分屏切换逻辑

### Fixed

- 修复主密码持久化问题（localStorage 改为文件系统）
- 修复点击"暂不设置"后仍然弹出主密码对话框的问题
- 修复启动加载慢的问题（优化初始化顺序）
- 修复分屏切换时显示错误的问题
- 修复同步输入模式下会话切换异常
- 修复手动 exit 命令触发自动重连的问题
- 修复终端搜索 API 权限问题
- 修复会话列表右键菜单丢失问题

### Documentation

- 新增完整的用户使用手册（doc/USER_MANUAL.md）
- 精简 README，详细内容链接到用户手册
- 更新项目介绍，突出开发初衷和特色
- 修复文档链接错误

## [1.0.4] - 2025-01-XX

### Added
- 终端字体大小快捷键调整
  - `Ctrl/Cmd + =` 或 `+` 放大（最大 24）
  - `Ctrl/Cmd + -` 缩小（最小 10）
  - `Ctrl/Cmd + 0` 重置（14）
- 字体大小自动保存到 localStorage
- 字体调整实时通知

### Changed
- 优化活动标签页颜色和样式

## [1.0.3] - 2025-01-XX

### Added
- 11 款预设主题
  - 深色模式、浅色模式
  - Dracula、Monokai、Solarized Dark
  - Nord、One Dark、GitHub Dark
  - Tokyo Night、Gruvbox Dark、Material
- 自定义主题支持
  - 自定义背景色、侧边栏、主色调
  - 自定义文字和边框颜色
  - 实时预览效果
- 终端设置
  - 字体大小调整（10-24）
  - 字体选择（Courier New, Monaco, Menlo, Consolas）
  - 光标样式（方块、下划线、竖线）
  - 光标闪烁开关

## [1.0.2] - 2025-01-XX

### Added
- WebDAV 配置同步
  - 支持坚果云、Nextcloud、Synology NAS
  - 智能合并本地和云端配置
  - 自动同步支持（可设置间隔）
  - 日志文件同步（可选）
  - 自定义日志同步路径
- 日志管理
  - 自动记录会话日志
  - 日志查看和搜索
  - 日志导出功能
  - 日志文件管理
  - 会话时长统计
- 版本更新检查
  - 自动检查更新（每天一次）
  - 手动检查更新
  - 版本号显示
  - 一键跳转下载

## [1.0.1] - 2025-01-XX

### Added
- 会话分组管理
  - 创建、重命名、删除分组
  - 会话拖拽到分组
  - 分组折叠/展开
- 会话搜索功能
  - 搜索名称、主机、用户名、分组
  - 实时过滤显示
  - 快捷键 `Ctrl/Cmd + F`
- 会话导入/导出
  - 导出所有会话配置
  - 从备份恢复配置
  - 加密密码信息

### Changed
- 优化会话列表布局
- 改进分组显示样式

## [1.0.0] - 2025-01-XX

### Added

#### 核心功能
- SSH2 协议支持
- 密码和密钥认证
- 多标签页终端
- 会话保存和管理
- 会话配置加密存储

#### 终端功能
- 完整的终端模拟（基于 xterm.js）
- 支持中文等多语言字符集（UTF-8）
- 终端大小自适应
- 复制粘贴支持
- 多会话同时运行

#### SFTP 文件传输
- 图形化文件管理器
- 文件上传/下载
- 拖拽上传支持
- 批量文件下载
- 文件/文件夹操作（重命名、删除、新建）
- 传输进度显示
- 传输取消功能
- 右键菜单支持

#### 用户体验
- 现代化深色主题
- 快捷键支持
- 实时通知提示
- 双击快速连接
- 连接状态反馈
- 响应式界面设计

#### 安全特性
- 密码加密存储（AES-256-CBC）
- 加密密钥本地保存
- SSH2 协议加密通信
- 会话隔离

#### 跨平台支持
- macOS（Apple Silicon & Intel）
- Windows（x64 & ARM64）
- Linux（x64 & ARM64）

[1.0.10]: https://github.com/chankay/anotherssh/compare/v1.0.9...v1.0.10
[1.0.9]: https://github.com/chankay/anotherssh/compare/v1.0.8...v1.0.9
[1.0.8]: https://github.com/chankay/anotherssh/compare/v1.0.7...v1.0.8
[1.0.4]: https://github.com/chankay/anotherssh/compare/v1.0.3...v1.0.4
[1.0.3]: https://github.com/chankay/anotherssh/compare/v1.0.2...v1.0.3
[1.0.2]: https://github.com/chankay/anotherssh/compare/v1.0.1...v1.0.2
[1.0.1]: https://github.com/chankay/anotherssh/compare/v1.0.0...v1.0.1
[1.0.0]: https://github.com/chankay/anotherssh/releases/tag/v1.0.0
